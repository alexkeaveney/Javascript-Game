<html>
    <head>
        <title>Lobby</title>
        <script src="../socket.io/socket.io.js"></script>
    </head>
    <body>
        <h1>Welcome guest</h1>
        <p>
            Putting you in a game now...
        </p>
        <div id ="Test"></div>

        <ul id="user_list"></ul>


        <button id="logout">Logout</button>
        <button id="startGame">Start Game</button>

        <script>
            document.getElementById('logout').addEventListener('click', function() {
                window.location.href = '/logout';
            });



            const socket = io.connect();

            function getParameterByName(name, url) {
                if (!url) url = window.location.href;
                name = name.replace(/[\[\]]/g, "\\$&");
                var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                    results = regex.exec(url);
                if (!results) return null;
                if (!results[2]) return '';
                return decodeURIComponent(results[2].replace(/\+/g, " "));
            }

            let user = getParameterByName("u");
            console.log(user);
            socket.emit('connectPlayer', user);

            document.getElementById('startGame').addEventListener('click', function() {
                socket.emit('startGame', user);
            });

            let userlist;

            socket.on('room'), function(message) {
                console.log(message);
            }

            socket.on('userList', function(users) {
              userList = users;
            });

            socket.on('addPlayer', function(user) {
              userList.push(user);
              console.log(userList);
            });

        </script>

    </body>
</html>
